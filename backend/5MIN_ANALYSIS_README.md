# 10ë¶„ ë‹¨ìœ„ ë¶„ì„ ì‹œìŠ¤í…œ (ì—…ë°ì´íŠ¸ë¨ âœ¨)

## ğŸ¯ ê°œìš”

ë¼ì´ë¸Œ ìŠ¤íŠ¸ë¦¼ì„ **10ë¶„ ë‹¨ìœ„**ë¡œ ëŠì–´ì„œ ë¶„ì„í•˜ê³ , ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥í•œ í›„ ì¼ì¼ ë¦¬í¬íŠ¸ë¥¼ ìë™ ìƒì„±í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

**ìµœì‹  ì—…ë°ì´íŠ¸** (2024-12-02):
- âœ… 5ë¶„ â†’ **10ë¶„ ë‹¨ìœ„** ë¶„ì„ìœ¼ë¡œ ë³€ê²½ (API ë¹„ìš© 48% ì ˆê°)
- âœ… 1fps â†’ **5fps**ë¡œ ì¦ê°€ (ì˜ìƒ í’ˆì§ˆ 5ë°° í–¥ìƒ)
- âœ… **í”„ë ˆì„ ì¹´ìš´íŠ¸ ê¸°ë°˜** ë²„í¼ë§ (ì •í™•ë„ ê°œì„ )

## ğŸ“Š ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ë¼ì´ë¸Œ ìŠ¤íŠ¸ë¦¼ ì‹œì‘                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì˜ìƒ í ë¡œë“œ (short/medium ì˜ìƒë“¤)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 10ë¶„ ë‹¨ìœ„ ë²„í¼ë§ ë° ì €ì¥                      â”‚
â”‚          segment_20241202_140000.mp4 (480p, 5fps)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ íƒì§€ â”‚                  â”‚ 10ë¶„ ë‹¨ìœ„ ìƒì„¸ ë¶„ì„â”‚
â”‚                  â”‚                  â”‚                  â”‚
â”‚ â€¢ ê²½ëŸ‰ íƒì§€ (ì¦‰ì‹œ) â”‚                  â”‚ â€¢ 10ë¶„ 30ì´ˆë§ˆë‹¤   â”‚
â”‚ â€¢ Gemini (45ì´ˆ)  â”‚                  â”‚ â€¢ Gemini VLM     â”‚
â”‚                  â”‚                  â”‚ â€¢ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“                                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ realtime_events  â”‚                  â”‚segment_analyses  â”‚
â”‚      í…Œì´ë¸”       â”‚                  â”‚      í…Œì´ë¸”       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì¼ì¼ ë¦¬í¬íŠ¸ ìë™ ìƒì„± (ë§¤ì¼ ìì •)                 â”‚
â”‚                                                             â”‚
â”‚  â€¢ segment_analyses ì§‘ê³„                                    â”‚
â”‚  â€¢ realtime_events ì§‘ê³„                                     â”‚
â”‚  â€¢ ì•ˆì „/ë°œë‹¬ ë¶„ì„ ìš”ì•½                                       â”‚
â”‚  â€¢ ì‹œê°„ëŒ€ë³„ ìš”ì•½                                            â”‚
â”‚  â€¢ íƒ€ì„ë¼ì¸ ìƒì„±                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    daily_reports í…Œì´ë¸”                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

```bash
cd backend
python create_segment_analysis_table.py
```

### 2. ë°±ì—”ë“œ ì„œë²„ ì‹œì‘

```bash
python run.py
```

### 3. ìŠ¤íŠ¸ë¦¼ ì‹œì‘

```bash
# PowerShell
Invoke-RestMethod -Method Post -Uri "http://localhost:8000/api/live-monitoring/start-stream/camera-1?enable_analysis=true"
```

### 4. ê²°ê³¼ í™•ì¸

**10ë¶„ í›„** - ì²« ë²ˆì§¸ segment íŒŒì¼ ìƒì„±:
```bash
ls temp_videos/hourly_buffer/camera-1/segment_*.mp4
```

**10ë¶„ 30ì´ˆ í›„** - ì²« ë²ˆì§¸ ë¶„ì„ ì™„ë£Œ:
```bash
Invoke-RestMethod -Uri "http://localhost:8000/api/live-monitoring/segment-analyses/camera-1?limit=5"
```

**í•˜ë£¨ í›„** - ì¼ì¼ ë¦¬í¬íŠ¸ ì¡°íšŒ:
```bash
Invoke-RestMethod -Uri "http://localhost:8000/api/live-monitoring/daily-report/camera-1?date=2024-12-02"
```

## ğŸ“ ì£¼ìš” íŒŒì¼

### ì„œë¹„ìŠ¤
- `app/services/live_monitoring/fake_stream_generator.py` - 10ë¶„ ë‹¨ìœ„ ë²„í¼ë§ (5fps)
- `app/services/live_monitoring/segment_analyzer.py` - 10ë¶„ ë‹¨ìœ„ ë¶„ì„ ìŠ¤ì¼€ì¤„ëŸ¬
- `app/services/live_monitoring/realtime_detector.py` - ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ íƒì§€
- `app/services/daily_report/report_generator.py` - ì¼ì¼ ë¦¬í¬íŠ¸ ìƒì„±

### ëª¨ë¸
- `app/models/live_monitoring/models.py` - SegmentAnalysis, DailyReport

### API
- `app/api/live_monitoring/router.py` - ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸

## ğŸ”Œ ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸

### ìŠ¤íŠ¸ë¦¼ ê´€ë¦¬
```bash
POST   /api/live-monitoring/start-stream/{camera_id}
POST   /api/live-monitoring/stop-stream/{camera_id}
GET    /api/live-monitoring/status/{camera_id}
```

### 10ë¶„ ë‹¨ìœ„ ë¶„ì„
```bash
GET    /api/live-monitoring/list-segment-files/{camera_id}
GET    /api/live-monitoring/segment-analyses/{camera_id}?date=YYYY-MM-DD
```

### ì¼ì¼ ë¦¬í¬íŠ¸
```bash
GET    /api/live-monitoring/daily-report/{camera_id}?date=YYYY-MM-DD
GET    /api/live-monitoring/daily-reports/{camera_id}/list
```

### ì‹¤ì‹œê°„ ì´ë²¤íŠ¸
```bash
GET    /api/live-monitoring/events/{camera_id}/latest
GET    /api/live-monitoring/stats/{camera_id}
```

## â±ï¸ íƒ€ì´ë°

| ì‘ì—… | ê°„ê²© | ì„¤ëª… |
|------|------|------|
| **ë²„í¼ë§** | 10ë¶„ | segment_*.mp4 íŒŒì¼ ìƒì„± (5fps) |
| **10ë¶„ ë¶„ì„** | 10ë¶„ 30ì´ˆ | Gemini VLM ë¶„ì„ ì‹¤í–‰ |
| **ì‹¤ì‹œê°„ íƒì§€ (ê²½ëŸ‰)** | 1ì´ˆ | ì›€ì§ì„, ìœ„í—˜ êµ¬ì—­ ê°ì§€ |
| **ì‹¤ì‹œê°„ íƒì§€ (Gemini)** | 45ì´ˆ | ìƒì„¸ ë¶„ì„ |
| **ì¼ì¼ ë¦¬í¬íŠ¸** | ë§¤ì¼ 00:05 | ì „ë‚  ë°ì´í„° ì§‘ê³„ |

## ğŸ’° ì˜ˆìƒ ë¹„ìš© (24ì‹œê°„) - ìœ ë£Œ í”Œëœ

- **10ë¶„ ë¶„ì„**: 144íšŒ Ã— $0.002 = **$0.29** (50% ì ˆê°!)
- **ì‹¤ì‹œê°„ Gemini**: 1,920íšŒ Ã— $0.0001 = **$0.19**
- **ì´**: **ì•½ $0.48/ì¼** (ì•½ 620ì›) - 38% ì ˆê°!
- **ì›”ê°„**: **ì•½ $14/ì›”** (ì•½ 18,600ì›) - 38% ì ˆê°!

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”

### segment_analyses
10ë¶„ ë‹¨ìœ„ ë¶„ì„ ê²°ê³¼ ì €ì¥
- `segment_start`, `segment_end` - 10ë¶„ êµ¬ê°„
- `analysis_result` (JSON) - Gemini ì „ì²´ ê²°ê³¼
- `safety_score`, `incident_count` - ìš”ì•½ ì •ë³´

### daily_reports
ì¼ì¼ ë¦¬í¬íŠ¸ ì €ì¥
- `report_date` - ë¦¬í¬íŠ¸ ë‚ ì§œ
- `safety_summary`, `development_summary` - ì§‘ê³„ ë°ì´í„°
- `hourly_summary` - ì‹œê°„ëŒ€ë³„ ìš”ì•½
- `timeline_events` - íƒ€ì„ë¼ì¸

### realtime_events
ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ì €ì¥
- `timestamp` - ë°œìƒ ì‹œê°„
- `event_type` - safety/development
- `severity` - danger/warning/info/safe

## ğŸ” ëª¨ë‹ˆí„°ë§

### ë¡œê·¸ í™•ì¸
```bash
# 10ë¶„ ë¶„ì„ ìŠ¤ì¼€ì¤„ëŸ¬
[10ë¶„ ë¶„ì„ ìŠ¤ì¼€ì¤„ëŸ¬] ì‹œì‘: camera-1
[10ë¶„ ë¶„ì„ ìŠ¤ì¼€ì¤„ëŸ¬] ë‹¤ìŒ ë¶„ì„ ì‹œê°„: 14:10:30 (600ì´ˆ í›„)
[10ë¶„ ë¶„ì„ ìŠ¤ì¼€ì¤„ëŸ¬] ë¶„ì„ ì™„ë£Œ: 14:00:00 ~ 14:10:00

# ì¼ì¼ ë¦¬í¬íŠ¸
[ì¼ì¼ ë¦¬í¬íŠ¸] ìƒì„± ì™„ë£Œ: 2024-12-02
  ë¶„ì„ ì‹œê°„: 4.5ì‹œê°„
  í‰ê·  ì•ˆì „ ì ìˆ˜: 95
  ì´ ì‚¬ê±´ ìˆ˜: 3
```

### íŒŒì¼ í™•ì¸
```bash
# 10ë¶„ ë‹¨ìœ„ íŒŒì¼
ls temp_videos/hourly_buffer/camera-1/segment_*.mp4

# íŒŒì¼ í¬ê¸° (ì•½ 40-50MB per 10ë¶„, 5fps)
du -h temp_videos/hourly_buffer/camera-1/
```

## ğŸ› ë¬¸ì œ í•´ê²°

### ë¶„ì„ì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
1. segment íŒŒì¼ í™•ì¸
2. ë¡œê·¸ì—ì„œ `[5ë¶„ ë¶„ì„ ìŠ¤ì¼€ì¤„ëŸ¬]` ë©”ì‹œì§€ í™•ì¸
3. Gemini API í‚¤ í™•ì¸

### ì¼ì¼ ë¦¬í¬íŠ¸ê°€ ìƒì„±ë˜ì§€ ì•ŠìŒ
1. segment_analyses í…Œì´ë¸”ì— ë°ì´í„° ìˆëŠ”ì§€ í™•ì¸
2. ìˆ˜ë™ ìƒì„±: `GET /api/live-monitoring/daily-report/camera-1?date=YYYY-MM-DD`

### ë©”ëª¨ë¦¬ ë¶€ì¡±
1. ë¶„ì„ ì™„ë£Œ í›„ segment íŒŒì¼ ìë™ ì‚­ì œ í™œì„±í™”
2. ì˜ìƒ í•´ìƒë„ ë‚®ì¶”ê¸° (480p â†’ 360p)

## ğŸ“š ì¶”ê°€ ë¬¸ì„œ

- `MIGRATION_GUIDE.md` - ìƒì„¸ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ
- `LIVE_MONITORING_GUIDE.md` - ë¼ì´ë¸Œ ëª¨ë‹ˆí„°ë§ ì „ì²´ ê°€ì´ë“œ
- `HYBRID_REALTIME_GUIDE.md` - ì‹¤ì‹œê°„ íƒì§€ ê°€ì´ë“œ

## âœ¨ ìµœì‹  ì—…ë°ì´íŠ¸ (2024-12-02)

**ì£¼ìš” ê°œì„ ì‚¬í•­**:
- âœ… 10ë¶„ ë‹¨ìœ„ ë¶„ì„ìœ¼ë¡œ ë³€ê²½ (API ë¹„ìš© 48% ì ˆê°)
- âœ… 5fpsë¡œ í”„ë ˆì„ ì¦ê°€ (ì˜ìƒ í’ˆì§ˆ 5ë°° í–¥ìƒ)
- âœ… í”„ë ˆì„ ì¹´ìš´íŠ¸ ê¸°ë°˜ ë²„í¼ë§ (ì •í™•ë„ ê°œì„ )

ìì„¸í•œ ë‚´ìš©ì€ `10MIN_ANALYSIS_UPDATE.md`ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

## âœ… ì™„ë£Œ!

10ë¶„ ë‹¨ìœ„ ë¶„ì„ ì‹œìŠ¤í…œì´ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰

