# 이슈 001: 프롬프트 시스템 구조 개편

## 이슈 요약
AI 분석의 정확도와 유지보수성을 높이기 위해, 거대하고 중복이 많은 단일 프롬프트 구조를 기능 단위로 모듈화하고 동적으로 조합하는 시스템으로 전환함.

## 상태
해결됨

## 원인: 단일 프롬프트 방식의 한계
모든 지시사항, 규칙, 예시를 하나의 거대한 프롬프트에 담았을 때 다음과 같은 치명적인 문제들이 발생했습니다.

1.  **인지 부하 및 주의력 분산**
    *   AI 모델의 입력 가능 길이(Context Window)는 한정적이며, 입력이 길어질수록 모델이 핵심 지시사항을 놓치거나 무시하는 '중간 내용 간과' 현상이 발생합니다.
    *   불필요한 정보(다른 단계의 기준 등)가 섞여 있어 모델이 현재 분석해야 할 상황에 집중하지 못하고 환각 현상을 일으킬 확률이 높아집니다.

2.  **유지보수의 어려움**
    *   작은 규칙 하나(예: 출력 데이터 형식 변경)를 수정하려 해도, 수천 줄짜리 파일을 열어 수정해야 하며, 이 과정에서 실수로 다른 중요한 로직을 건드릴 위험이 매우 큽니다.
    *   동일한 규칙이 여러 파일에 복사-붙여넣기 되어 있다면, 하나만 수정하고 나머지는 누락하는 실수가 필연적으로 발생합니다.

3.  **비효율적인 비용 구조**
    *   매 요청마다 불필요한 텍스트(사용하지 않는 단계의 기준 등)까지 모두 전송하므로, 비용이 낭비됩니다.

4.  **디버깅의 어려움**
    *   원하는 결과가 나오지 않았을 때, 프롬프트의 어느 부분이 문제인지 특정하기가 매우 어렵습니다.

## 해결 방법
시스템을 **모듈화**하고 **동적 조립**하는 방식으로 구조를 개선함.

### 1. 프롬프트 모듈화
전체 프롬프트를 역할과 성격에 따라 세 가지 핵심 영역으로 분리하여 관리:
- **공통 모듈**: 모든 분석 단계에서 변하지 않는 기본 원칙, 안전 수칙, 출력 형식 정의.
- **단계별 기준**: 각 발달 단계(월령)에 특화된 고유 체크리스트와 판단 기준.
- **추출 전용**: 영상에서 객관적 사실(메타데이터)만을 뽑아내기 위한 독립된 지침.

### 2. 동적 프롬프트 조립
정적인 텍스트 파일을 그대로 사용하는 대신, 요청 상황에 맞춰 필요한 모듈들을 실시간으로 조립하여 최적의 프롬프트를 생성하는 로직 구현.
- **유연성**: 공통 모듈 수정 한 번으로 모든 단계에 즉시 변경 사항 반영.
- **정확성**: AI에게 필요한 정보만 선별하여 제공함으로써 효율성 및 지시 이행률 향상.

### 3. 결과
- 유지보수 복잡도를 낮추고 시스템의 유연성을 확보함.
- 개념적 분리를 통해 향후 새로운 분석 모델이나 기준 도입이 용이해짐.
